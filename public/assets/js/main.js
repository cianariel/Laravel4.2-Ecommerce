/*! Ideaing 01-04-2016 */
angular.module("pagingApp",["pagingApp.controllers","pagingApp.filters","cgBusy"]),angular.module("pagingApp.controllers",["ui.bootstrap"]).directive("heartCounterDir",["$http",function(a){return{restrict:"E",transclude:!0,replace:!0,scope:{uid:"=",iid:"=",plink:"=",sec:"="},controller:function(b,c,d){b.unHeart=!1,b.heartCounter=0,b.heartCounterAction=function(){a({url:"/api/heart/count-heart",method:"POST",data:{section:d.sec,uid:b.uid,iid:b.iid,plink:b.plink}}).success(function(a){d.ustatus=a.UserStatus,b.unHeart=a.UserStatus,b.heartCounter=a.Count})},b.cleanUrl=function(a){var b="https://"+window.location.host+"/ideas/";return a.replace(b,"")},b.heartAction=function(){0!=d.uid&&a({url:"/api/heart/add-heart",method:"POST",data:{section:d.sec,uid:b.uid,iid:b.iid,plink:b.cleanUrl(b.plink),uht:b.unHeart}}).success(function(a){b.heartCounterAction(),b.unHeart=!b.unHeart})},b.heartCounterAction()},template:'      <div class="">                    <a href="#" class="likes"                       ng-click="heartAction()"                    >                        <i ng-class="unHeart != false ? \'m-icon m-icon--heart-solid\' : \'m-icon m-icon--ScrollingHeaderHeart\'">                                <span class="m-hover">                                    <span class="path1"></span><span class="path2"></span>                                </span>                        </i>                        <span class="social-stats__text" ng-bind="heartCounter">&nbsp; </span>                    </a>                </div>'}}]).controller("pagingController",function(a,b,c,d,e,f){a.allContent=[],a.content=[],a.newStuff=[],a.currentPage=1,a.contentBlock=angular.element(document.querySelector(".main-content")),a.filterLoad=[],a.ideaCategory=!1,a.renderHTML=function(a){var b=angular.element("<div />").html(a).text();return b};var g=f("getURISegment")(2),h=0;if("idea"==g)a.currentTag=f("getURISegment")(3);else if("ideas"==g){a.filterBy="idea","category"==f("getURISegment")(3)?a.ideaCategory=f("getURISegment")(4):a.ideaCategory=f("getURISegment")(3);var h=9}a.firstLoad=e.getGridContent(1,h,a.currentTag,a.filterBy,a.ideaCategory).success(function(b){a.allContent[0]=b,a.content[0]=a.sliceToRows(b.regular,b.featured)}),a.loadMore=function(){if(a.currentPage++,a.allContent[a.currentPage]=[],a.filterBy&&"undefined"!=typeof a.filterBy)var b=9;else{var b=0;a.filterBy=null}a.nextLoad=e.getGridContent(a.currentPage,b,a.currentTag,a.filterBy,a.ideaCategory).success(function(b){a.newStuff[0]=a.sliceToRows(b.regular,b.featured),a.content=a.content.concat(a.newStuff),a.allContent[a.currentPage].regular=b.regular,a.allContent[a.currentPage].featured=b.featured})},a.filterContent=function(b){$(".main-content").fadeOut(500,function(){var c=[];return a.filterBy===b?!0:"undefined"==typeof b||null===b||"all"===b?(a.nextLoad=e.getGridContent(1,0,a.currentTag).success(function(b){a.allContent[0]=b,c[0]=a.sliceToRows(b.regular,b.featured)}),a.currentPage=1,a.filterBy=null,a.content=c,$(".main-content").fadeIn(),!0):(a.filterBy=b,void(a.nextLoad=e.getFilteredContent(a.currentPage,a.currentTag,b,a.sliceToRows).then(function(b){var c=b;a.content=c,a.allContent=a.allContent.concat(c),$(".main-content").fadeIn(500)})))})},a.sliceToRows=function(a,b){var c=[];return c["row-1"]=a.slice(0,3),c["row-2"]=b[0]?[b[0]]:!1,c["row-3"]=a.slice(3,6),c["row-4"]=b[1]?[b[1]]:!1,c["row-5"]=a.slice(6,9),c["row-6"]=b[2]?[b[2]]:!1,c},a.fadeAnimation=function(a,b,c){$(a).fadeOut(c())},a.subscribe=function(){a.responseMessage="",d({url:"/api/subscribe",method:"POST",data:{Email:a.SubscriberEmail}}).success(function(b){406==b.status_code?a.responseMessage="Invalid Email !":200==b.status_code?(a.responseMessage="Successfully Subscribed",a.SubscriberEmail=""):a.responseMessage="Email already subscribed"})},a.open=function(a){var b="room-related-product-"+a+".html";c.open({templateUrl:b,size:"lg",controller:"ModalInstanceCtrltest"})},a.openProfileSetting=function(){var a="profile-setting.html";c.open({templateUrl:a,size:"lg",windowClass:"profile-setting-modal",controller:"ModalInstanceCtrltest"})},a.openProductPopup=function(d){e.openProductPopup(a,c,b,d)}}).controller("SearchController",function(a,b,c,d,e,f,g){function h(a,b){var c=a.target;if(c){var d=c.classList;console.log(c.classList);var e=d.contains("top-search")||d.contains("cat-suggestions");return e?void 0:void b()}}var i=f("getURISegment")(2),j=!1;"search"==i&&(j=f("getURISegment")(3))&&(a.$searchQuery=j),a.currentPage=1,a.offset=0,a.type="undefined",a.sortBy=!1,a.nextLoad=d.getSearchContent(a.$searchQuery,15,0).success(function(b){a.content=b.content,$("#search-header").show(),$("#hit-count").text(b.count)}),a.loadMore=function(){a.currentPage++,a.offset=15*a.currentPage++,a.nextLoad=d.getSearchContent(a.$searchQuery,15,a.offset,a.type,a.sortBy).success(function(b){var c=a.content.concat(b.content);a.sortBy&&c.sort(function(b,c){return parseFloat(b[a.sortBy])-parseFloat(c[a.sortBy])}),a.content=c})},a.filterSearchContent=function(b,c){if(b||(b=a.type),b){if(!c&&$('a[data-filterby="'+b+'"]').hasClass("active"))return!0;a.type=b,a.currentPage=1,a.offset=0,$("a[data-filterby]").removeClass("active"),$('a[data-filterby="'+b+'"]').addClass("active")}if("all"==b&&($("a[data-filterby]").removeClass("active"),$('a[data-filterby="false"]').addClass("active"),b="undefined"),c||(c=a.sortBy),c&&"undefined"!=c){if(!b&&$('a[data-sotyby="'+c+'"]').hasClass("active"))return!0;a.sortBy=c,a.currentPage=1,a.offset=0,$("a[data-sortby]").removeClass("active"),$('a[data-sortby="'+c+'"]').addClass("active")}var e=$(".grid-box-3");e.fadeOut(500,function(){a.nextLoad=d.getSearchContent(a.$searchQuery,15,a.offset,b,c).success(function(b){a.content=b.content,$("#hit-count").text(b.count),e.fadeIn()})})},a.openSearchDropdown=function(c){console.log(c),b({method:"get",url:"/api/search/find-categories/"+c}).success(function(b){a.categorySuggestions=b}).error(function(b){a.categorySuggestions=[]})},a.renderHTML=function(a){var b=angular.element("<div />").html(a).text();return b},a.$window=g,a.open=!1,a.toggleSearch=function(){console.log("toggle"),a.open=!a.open,console.log(a.open),a.open?a.$window.onclick=function(b){h(b,a.toggleSearch)}:(a.open=!1,a.$window.onclick=null,a.$apply())},a.openProductPopup=function(b){d.openProductPopup(a,c,e,b)}}).controller("ModalInstanceCtrltest",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}).controller("shoplandingController",["$scope","$http","pagingApi","$timeout","$uibModal",function(a,b,c,d,e){a.renderHTML=function(a){var b=angular.element("<div />").html(a).text();return b},a.openProductPopup=function(b){c.openProductPopup(a,e,d,b)},a.nextLoad=c.getPlainContent(1,3,"deal","idea").success(function(b){a.dailyDeals=b,d(function(){jQuery("#daily-deals").royalSlider({arrowsNav:!0,loop:!1,keyboardNavEnabled:!0,controlsInside:!1,imageScaleMode:"fit",arrowsNavAutoHide:!1,controlNavigation:"bullets",thumbsFitInViewport:!1,navigateByClick:!1,startSlideId:0,autoPlay:!1,transitionType:"move",globalCaption:!1,deeplinking:{enabled:!0,change:!1},imgWidth:"100%",autoHeight:!0,imageScaleMode:"fill"})},100)}),c.getPlainContent(1,9,!1,"product").success(function(b){a.newestArrivals=[];for(var c=0;c<=b.length;c++)if(c%3==0)var e=[b[c]];else e.push(b[c]),c%3!=2&&c!=b.length-1||a.newestArrivals.push(e);d(function(){jQuery("#newest-arrivals").royalSlider({arrowsNav:!0,loop:!1,keyboardNavEnabled:!0,controlsInside:!1,arrowsNavAutoHide:!1,controlNavigation:"bullets",thumbsFitInViewport:!1,navigateByClick:!1,startSlideId:0,autoPlay:!1,transitionType:"move",globalCaption:!1,deeplinking:{enabled:!0,change:!1},imgWidth:"100%",imageScaleMode:"fill",autoHeight:!0},100)})})}]).controller("shopcategoryController",function(a,b,c,d,e){a.renderHTML=function(a){var b=angular.element("<div />").html(a).text();return b},a.openProductPopup=function(b){c.openProductPopup(a,d,e,b)},a.currentPage=1,a.currentCategory=!1,a.$filterBy=!1,a.sortBy=!1;var f=b("getURISegment")(2),g=!1;"shop"==f&&((g=b("getURISegment")(5))?a.currentCategory=g:(g=b("getURISegment")(4))?a.currentCategory=g:a.currentCategory=b("getURISegment")(3)),a.nextLoad=c.getPlainContent(1,15,a.currentCategory,"product",a.currentCategory).success(function(b){a.sortBy&&b.sort(function(b,c){return parseFloat(b[a.sortBy])-parseFloat(c[a.sortBy])}),a.content=b}),a.loadMore=function(){a.currentPage++;var b=15;a.nextLoad=c.getPlainContent(a.currentPage,b,a.currentCategory,"product",a.currentCategory).success(function(b){var c=a.content.concat(b);a.sortBy&&c.sort(function(b,c){return parseFloat(b[a.sortBy])-parseFloat(c[a.sortBy])}),a.content=c})},a.filterPlainContent=function(b,d){if(b){if($('a[data-filterby="'+b+'"]').hasClass("active"))return!0;a.currentCategory=b,$("a[data-filterby]").removeClass("active"),$('a[data-filterby="'+b+'"]').addClass("active")}if(d&&"undefined"!=d&&d!=a.sortBy){if($('a[data-sotyby="'+d+'"]').hasClass("active"))return!0;$("a[data-sortby]").removeClass("active"),$('a[data-sortby="'+d+'"]').addClass("active")}var e=$(".grid-box-3");e.fadeOut(500,function(){a.nextLoad=c.getPlainContent(1,15,a.currentCategory,"product",a.currentCategory).success(function(b){0!=d&&(a.sortBy=d),a.sortBy&&"default"!=a.sortBy&&b.sort(function(b,c){return parseFloat(b[a.sortBy])-parseFloat(c[a.sortBy])}),a.content=b,e.fadeIn()})})}}).directive("a",function(){return{restrict:"E",link:function(a,b,c){(c.ngClick||""===c.href||"#"===c.href)&&b.on("click",function(a){a.preventDefault()})}}}).factory("pagingApi",function(a,b,c){var d={};return d.openProductPopup=function(b,c,d,e){var f=angular.element(document).find("body");if(!(f[0].offsetWidth<880)){document.getElementsByTagName("html")[0].className+=" hide-overflow ";var g="product-popup.html",h=c.open({templateUrl:g,size:"lg",windowClass:"product-popup-modal",controller:"ModalInstanceCtrltest"});h.opened.then(function(){d(function(){a({url:"/api/product/get-product/"+e,method:"get"}).success(function(b){if(200==b.status_code){var b=b.data,c="";for(var d in b.selfImages.picture){var f=b.selfImages.picture[d];c+='                                    <div>                                        <img class="rsImg "                                              src="'+f.link+'"                                             class="attachment-large wp-post-image"                                             alt=""/>                                    </div>                                '}$(".product-popup-modal #product-slider").html(c),$(".product-popup-modal .p-title").html("<a target='_blank' href='/product/"+b.productInformation.Permalink+"'>"+b.productInformation.ProductName+"</a>");var g='                                <a class="get-round" href="'+b.productInformation.AffiliateLink+'" target="_blank">Get it</a>                                <img class="vendor-logo" width="107" src="'+b.storeInformation.ImagePath+'" alt="'+b.storeInformation.StoreName+'">                            ';if($(".product-popup-modal .p-get-it-amazon .p-body").html(g),b.productInformation.Review)var h=parseInt(((Number(b.productInformation.Review[0].value)>0?Number(b.productInformation.Review[0].value):Number(b.productInformation.Review[1].value))+Number(b.productInformation.Review[1].value))/2*20)+"%";else var h="0%";$(".product-popup-modal .p-score").html(h);var i;i=b.productInformation.SellPrice?b.productInformation.SellPrice:0,$(".product-popup-modal .aws-price").html(i);var j;j=b.productInformation.Description?b.productInformation.Description:"",$("#features").html(j);var k="";for($stars=b.productInformation.Review[0].value,$fStar=Math.floor($stars),$cStar=Math.ceil($stars),$halfStar=-1,$fStar==$cStar&&($halfStar=$cStar),$i=1;$i<=5;$i++)k+=$i<=$fStar?'                                        <span class="star active">                                            <i class="m-icon--star-blue-full"></i>                                        </span>                                        ':$cStar==$i?'                                        <span class="star half">                                            <i class=" m-icon--star-blue-half2"></i>                                        </span>                                        ':'                                        <span class="star">                                            <i class=" m-icon--star-blue-full-lines"></i>                                        </span>                                        ';$(".product-popup-modal .critic .star-rating").html(k);var l=""==b.productInformation.Review[0].counter?0:b.productInformation.Review[0].counter;if(l>1)var m=l+'                                        <span class="light-black">                                            Reviews                                        </span>                                    ';else var m=l+'                                        <span class="light-black">                                            Review                                        </span>                                    ';$(".product-popup-modal .critic .star-rating-label").html(m);var n="";if(b.productInformation.Review){var o=b.productInformation.Review.slice(2);for(reviewKey in o){var p=o[reviewKey];for(console.log("reviewKey",reviewKey),console.log("review",p),n+='                                            <div class="critic-outer-rating">                                                <div class="line-label ">                                                    <a                                                        href="'+p.link+'"                                                        target="_blank">'+p.key+'                                                    </a></div>                                                <div class="star-rating" style="text-align: center">',$stars=p.value?p.value:0,$fStar=Math.floor($stars),$cStar=Math.ceil($stars),$halfStar=-1,$fStar==$cStar&&($halfStar=$cStar),$i=1;$i<=5;$i++)n+=$i<=$fStar?'                                                                <span class="star active">                                                                    <i class="m-icon--star-blue-full"></i>                                                                </span>                                                            ':$cStar==$i?'                                                                <span class="star half">                                                                    <i class=" m-icon--star-blue-half2"></i>                                                                </span>                                                            ':'                                                                <span class="star">                                                                    <i class=" m-icon--star-blue-full-lines"></i>                                                                </span>                                                            ';n+="                                                </div>                                            </div>                                        "}}jQuery(".product-popup-modal .critic #critic-outer-rating-holder").html(n);var k="";for($stars=b.productInformation.Review[1].value,$fStar=Math.floor($stars),$cStar=Math.ceil($stars),$halfStar=-1,$fStar==$cStar&&($halfStar=$cStar),$i=1;$i<=5;$i++)k+=$i<=$fStar?'                                        <span class="star active">                                            <i class="m-icon--star-blue-full"></i>                                        </span>                                        ':$cStar==$i?'                                        <span class="star half">                                            <i class=" m-icon--star-blue-half2"></i>                                        </span>                                        ':'                                        <span class="star">                                            <i class=" m-icon--star-blue-full-lines"></i>                                        </span>                                        ';$(".product-popup-modal .amazon .star-rating").html(k);var l=""==b.productInformation.Review[1].counter?0:b.productInformation.Review[1].counter,m='<a href="'+(b.productInformation.Review[1].link?b.productInformation.Review[1].link:"#")+'" target="_blank">';m+=l>1?l+'                                        <span class="light-black">                                            Reviews                                        </span>                                    ':l+'                                        <span class="light-black">                                            Review                                        </span>                                    ',m+="</a>",$(".product-popup-modal .amazon .star-rating-label").html(m);var q="                                <div>"+(b.productInformation.ReviewExtLink?b.productInformation.ReviewExtLink:"")+"</div>";$(".product-popup-modal .critic-quote").html(q),a({url:"/api/comment/get-product-comment/"+e,method:"GET"}).success(function(a){for(var b=a.data,c=b.length,d=2>c?c+" Comment":c+" Comments",e="",f=0;f<b.length;f++){var g=b[f];e+='                                        <div class="p-comment-row">                                            <div class="pull-left text-center p-comment-user">                                                <img src="'+g.Picture+'" width="50px" class="p-photo"><br>'+g.UserName+'</div>                                            <div class="p-comment">'+g.Comment+'<div class="p-footer">                                                    <time class="p-time pull-left">'+g.PostTime+'</time>                                                    <div class="clearfix"></div>                                                </div>                                            </div>                                        </div>                                    '}$(".p-comment-content-holder").html(e),$(".p-comment-responses").html(d),console.log("comments",b)}),jQuery("#product-slider").royalSlider({loop:!1,keyboardNavEnabled:!0,controlsInside:!1,imageScaleMode:"fit",arrowsNavAutoHide:!1,controlNavigation:"thumbnails",thumbsFitInViewport:!1,navigateByClick:!0,startSlideId:0,autoPlay:!1,transitionType:"move",globalCaption:!1,autoScaleSlider:!1,imgHeight:"100%",deeplinking:{enabled:!0,change:!1},autoHeight:!0}),document.getElementById("product-slider").style.visibility="visible"}})},100)}),h.result["finally"](function(){var a=document.getElementsByTagName("html")[0].className;a=a.replace("hide-overflow",""),document.getElementsByTagName("html")[0].className=a})}},d.fakeUpdateCounts=function(a){var b=$('.share-buttons a[data-service="'+a+'"]').children(".share-count"),c=$("b.share-count.all"),d=Number(b.html());b.html(d+1);var e=Number(c.html());c.html(e+1)},d.openSharingModal=function(a,c){var e="https://"+window.location.host+window.location.pathname,f=!1,g=function(){var a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src","https://assets.pinterest.com/js/pinmarklet.js?r="+99999999*Math.random()),document.body.appendChild(a),setTimeout(function(){d.fakeUpdateCounts("pinterest")},1e4)};switch(a){case"facebook":f="https://www.facebook.com/sharer/sharer.php?u="+e;break;case"twitter":f="https://twitter.com/share?url="+e+"&counturl="+e+"&text=@Ideaing";break;case"googleplus":f="https://plus.google.com/share?url="+e;break;case"pinterest":return g(),!0}if(!f)return!1;var h=b.open(f,"C-Sharpcorner","width=500,height=400"),i=setInterval(function(){h.closed&&(clearInterval(i),setTimeout(function(){d.fakeUpdateCounts(a)},2e3),console.log("share counters updated"))},1e3)},d.getPlainContent=function(b,c,d,e,f,g){return a({method:"GET",url:"/api/paging/get-content/"+b+"/"+c+"/"+d+"/"+e+"/"+f+"/"+g})},d.getGridContent=function(b,c,d,e,f){return a({method:"GET",url:"/api/paging/get-grid-content/"+b+"/"+c+"/"+d+"/"+e+"/"+f})},d.getSearchContent=function(b,c,d,e,f){return a({method:"get",url:"/api/find/"+b+"/"+c+"/"+d+"/"+e+"/"+f})},d.getFilteredContent=function(b,d,e,f){for(var g=[],h=1;b+1>h;h++)g.push(a.get("/api/paging/get-grid-content/"+h+"/9/"+d+"/"+e));var i=c.all(g).then(function(a){var b=0,c=[];a.forEach(function(a){var d=[];d.regular=a.data.regular,null!=e&&"idea"!=e?d.featured=[]:d.featured=a.data.featured,c[b]=f(d.regular,d.featured),b++});var d=c;return d});return i},d}),angular.module("pagingApp").value("cgBusyDefaults",{message:"",backdrop:!1,templateUrl:"/assets/svg/spinner.html",delay:300,minDuration:700,wrapperClass:""}),angular.module("pagingApp.filters",[]).filter("getURISegment",function(a){return function(b){var c=a.protocol()+"://"+a.host()+"/",d=a.absUrl().replace(c,""),e=d.split("/");return e[b-2]?e[b-2]:!1}});var productApp=angular.module("productApp",["ui.bootstrap","autocomplete","ngSanitize","angular-confirm","textAngular"]);productApp.directive("heartCounterProduct",["$http",function(a){return{restrict:"E",transclude:!0,replace:!0,scope:{uid:"=",iid:"=",plink:"=",sec:"="},controller:function(b,c,d){b.unHeart=!1,b.heartCounter=0,b.heartCounterAction=function(){a({url:"/api/heart/count-heart",method:"POST",data:{section:d.sec,uid:b.uid,iid:b.iid,plink:b.cleanUrl(b.plink)}}).success(function(a){d.ustatus=a.UserStatus,b.unHeart=a.UserStatus,b.heartCounter=a.Count})},b.cleanUrl=function(a){a=a.toString();var b="https://"+window.location.host+"/ideas/",c=a.replace(b,"");return c},b.heartAction=function(){0!=d.uid&&a({url:"/api/heart/add-heart",method:"POST",data:{section:d.sec,uid:b.uid,iid:b.iid,plink:b.cleanUrl(b.plink),uht:b.unHeart}}).success(function(a){b.heartCounterAction(),b.unHeart=!b.unHeart})},b.heartCounterAction()},template:'      <div class="">                    <a class="likes"                       ng-click="heartAction()"                    >                        <i ng-class="unHeart != false ? \'m-icon m-icon--heart-solid\' : \'m-icon m-icon--ScrollingHeaderHeart\'">                                <span class="m-hover">                                    <span class="path1"></span><span class="path2"></span>                                </span>                        </i>                        <span class="social-stats__text" ng-bind="heartCounter">&nbsp; </span>                    </a>                </div>'}}]),productApp.config(["$provide",function(a){a.decorator("taOptions",["taRegisterTool","$delegate",function(a,b){return b.forceTextAngularSanitize=!0,b.keyMappings=[],a("insertCustomImage",{iconclass:"fa fa-picture-o",action:function(){this.$editor().$parent.insertCustomImagePopup()}}),b.toolbar=[["bold","insertCustomImage"]],b.classes={focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",disabled:"disabled",textEditor:"form-control",htmlEditor:"form-control"},b}])}]),productApp.controller("productController",["$scope","$http","$window","$interval","$timeout",function(a,b,c,d,e){a.focusEditor=function(){e(function(){angular.element("div[contenteditable=true]").trigger("focus")})},a.insertCustomImagePopup=function(){alert("Please add the code for photo uploading here")},a.textAreaSetup=function(a){a.attr("focus-me","focus_editor")},a.initPage=function(){a.productInformation=[],a.relatedProducts=[],a.selfImages=[],a.permalink=c.permalink,a.ProductName="",a.Description="",a.tmp="/assets/images/dummies/slider/PC220020-1024x683.jpg",a.selectedProduct="",a.comparableProductList=[],a.suggestedItems=[],a.suggestedItemsWithId=[],a.specList=[],a.compareIndex=0,a.dataLength=0,a.temporaryViewList=[],a.showCompareButton=!0,a.html="",a.comments=[],a.commentsCount=0,a.commentsCountView="",a.productId=0,a.userId=0,a.isAdmin=!1,a.isEdit=!1,a.commentId=null,a.unHeart=!1,a.heartCounter=0},a.heartAction=function(c,d,e,f){0!=c&&b({url:"/api/heart/add-heart",method:"POST",data:{uid:c,iid:d,plink:e,section:f,uht:a.unHeart}}).success(function(b){a.heartCounterAction(c,d,f),a.unHeart=!a.unHeart})},a.heartCounterAction=function(c,d,e){b({url:"/api/heart/count-heart",method:"POST",data:{uid:c,iid:d,section:e}}).success(function(b){a.unHeart=b.UserStatus,a.heartCounter=b.Count})},a.addCommentForProduct=function(c,d,e,f){b({url:"/api/comment/add-product-comment",method:"POST",data:{uid:c,pid:d,plink:e,comment:f}}).success(function(b){a.html="",a.getCommentsForProduct(a.productId)})},a.getCommentsForProduct=function(c){b({url:"/api/comment/get-product-comment/"+c,method:"GET"}).success(function(b){a.productId=c,a.comments=b.data,a.commentsCount=a.comments.length,a.commentsCountView=a.commentsCount<2?a.commentsCount+" Comment":a.commentsCount+" Comments"})};d(function(){0!=a.productId&&a.getCommentsForProduct(a.productId)},15e3);a.editComment=function(b){a.isEdit=!0,a.commentId=b.CommentId,a.html=b.Comment},a.updateCommentForProduct=function(c,d){b({url:"/api/comment/update-comment",method:"POST",data:{cid:a.commentId,comment:a.html}}).success(function(b){a.html="",a.isEdit=!1,a.getCommentsForProduct(a.productId)})},a.deleteCommentForProduct=function(c){b({url:"/api/comment/delete-comment",method:"POST",data:{cid:c}}).success(function(b){a.getCommentsForProduct(a.productId)})},a.toggleCompareButton=function(){a.showCompareButton=!a.showCompareButton},a.searchProductByName=function(c){c.length<3||(a.suggestedItems=[],a.suggestedItemsWithId=[],b({url:"/api/product/product-find/"+c,method:"GET"}).success(function(b){for(var c=0;c<b.length;c++)a.suggestedItems.push(b[c].name),a.suggestedItemsWithId.push(b)}))},a.selectedIdem=function(c){b({url:"/api/product/get-by-name/"+c,method:"GET"}).success(function(b){a.comparableProductList.push(b),a.temporaryViewList=a.comparableProductList.slice(a.compareIndex,a.compareIndex+3),a.dataLength=a.comparableProductList.length,a.selectedProduct="",a.toggleCompareButton()})},a.deleteSelectedItem=function(b){a.comparableProductList.splice(b,1),a.dataLength=a.comparableProductList.length,a.temporaryViewList=a.comparableProductList.slice(a.compareIndex,a.compareIndex+3)},a.traverseForward=function(){a.compareIndex<=a.dataLength-1&&a.compareIndex++,a.temporaryViewList=a.comparableProductList.slice(a.compareIndex,a.compareIndex+3)},a.traverseBackward=function(){a.compareIndex>=1&&a.compareIndex--,a.temporaryViewList=a.comparableProductList.slice(a.compareIndex,a.compareIndex+3)},a.loadProductDetails=function(){b({url:"/api/pro-details/"+a.permalink,method:"GET"}).success(function(b){if(200==b.status_code){a.comparableProductList.push(b),a.temporaryViewList=a.comparableProductList.slice(a.compareIndex,a.compareIndex+3),a.dataLength=a.comparableProductList.length;for(var c=b.data.productInformation.Specifications,d=0;d<c.length;d++){var e=c[d].key;e=e.split(/(?=[A-Z])/).join(" "),a.specList.push(e)}}})},a.initPage()}]);var publicApp=angular.module("publicApp",["ui.bootstrap","ngSanitize","angularFileUpload"]);publicApp.directive("heartCounterPublic",["$http",function(a){return{restrict:"E",transclude:!0,replace:!0,scope:{uid:"=",iid:"=",plink:"=",sec:"="},controller:function(b,c,d){b.unHeart=!1,b.heartCounter=0,b.heartCounterAction=function(){a({url:"/api/heart/count-heart",method:"POST",data:{section:d.sec,uid:b.uid,iid:b.iid,plink:b.cleanUrl(d.plink)}}).success(function(a){d.ustatus=a.UserStatus,b.unHeart=a.UserStatus,b.heartCounter=a.Count})},b.cleanUrl=function(a){return a},b.heartAction=function(){0!=d.uid&&a({url:"/api/heart/add-heart",method:"POST",data:{section:d.sec,uid:b.uid,iid:b.iid,plink:b.cleanUrl(d.plink),uht:b.unHeart}}).success(function(a){b.heartCounterAction(),b.unHeart=!b.unHeart})},b.heartCounterAction()},template:'      <div class="">                    <a class="likes"                       ng-click="heartAction()"                    >                        <i ng-class="unHeart != false ? \'m-icon m-icon--heart-solid\' : \'m-icon m-icon--ScrollingHeaderHeart\'">                                <span class="m-hover">                                    <span class="path1"></span><span class="path2"></span>                                </span>                        </i>                        <span class="social-stats__text" ng-bind="heartCounter">&nbsp; </span>                    </a>                </div>'}}]),publicApp.directive("showAuthorInfo",["$http",function(a){return{restrict:"E",transclude:!0,replace:!0,scope:{email:"@",url:"@"},controller:function(b,c,d){b.authorInfo=function(){a({url:"/api/info-raw/"+b.email,method:"GET"}).success(function(a){b.authorName=a.name,b.authorImage=a.medias[0].media_link,b.authorBio=a.user_profile.personal_info})},b.authorInfo()},template:'      <div class="box-item__author">                    <a href="{{ url }}" class="user-widget">                       <img class="user-widget__img" src="{{ authorImage }}">                     <span class="user-widget__name">{{ authorName }}</span>                    </a>                </div>'}}]),publicApp.config(["$httpProvider",function(a){a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]),publicApp.factory("layoutApi",function(a){var b={};return b.getProductsForShopMenu=function(){return a({method:"GET",url:"/api/layout/get-shop-menu"})},b}).directive("a",function(){return{restrict:"E",link:function(a,b,c){(c.ngClick||""===c.href||"#"===c.href)&&b.on("click",function(a){a.preventDefault()})}}}),publicApp.controller("ModalInstanceCtrltest",function(a,b,c){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")},a.openSharingModal=function(a){c.openSharingModal(a)}}),publicApp.controller("publicController",["$rootScope","$scope","$http","$window","$timeout","$location","$anchorScroll","$uibModal","layoutApi","$compile","$interval","FileUploader","pagingApi",function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.focusEditor=function(){e(function(){angular.element("div[contenteditable=true]").trigger("focus")})},b.insertCustomImagePopup=function(){alert("Please add the code for photo uploading here")},b.textAreaSetup=function(a){a.attr("focus-me","focus_editor")};k(function(){null!=b.uid&&b.loadNotification(b.uid),0!=b.itemId&&b.getCommentsForIdeas(b.itemId)},15e3);a.isCallEmailPopup||e(function(){if(b.canOpenEmailPopup){var a="subscribe_email_popup.html";h.open({templateUrl:a,scope:b,size:"md",windowClass:"subscribe_email_popup",controller:"ModalInstanceCtrltest"}).result["finally"](function(){b.uploader.formData=[]})}},3e5),a.isCallEmailPopup=!0,b.openProfileSetting=function(){var a="profile-setting.html";h.open({templateUrl:a,scope:b,size:"lg",windowClass:"profile-setting-modal",controller:"ModalInstanceCtrltest"}).result["finally"](function(){b.uploader.formData=[]})},b.openSharingModal=function(a){m.openSharingModal(a,b)},i.getProductsForShopMenu().success(function(a){b.productsForShopMenu=a}),uploader=b.uploader=new l({url:"/api/media/media-upload"}),uploader.filters.push({name:"customFilter",fn:function(a,b){return this.queue.length<10}}),uploader.onWhenAddingFileFailed=function(a,b,c){},uploader.onAfterAddingFile=function(a){b.isProfilePage&&(b.oldMediaLink=b.mediaLink,b.showBrowseButton=!b.showBrowseButton,b.uploader.uploadAll(),console.log(b.oldMediaLink," : ",b.MediaLink))},uploader.onAfterAddingAll=function(a){},uploader.onBeforeUploadItem=function(a){},uploader.onProgressItem=function(a,c){b.initProfilePicture("/assets/images/ajax-loader.gif")},uploader.onProgressAll=function(a){},uploader.onSuccessItem=function(a,b,c,d){},uploader.onErrorItem=function(a,b,c,d){},uploader.onCancelItem=function(a,b,c,d){},uploader.onCompleteItem=function(a,c,d,e){b.mediaLink=c.result},uploader.onCompleteAll=function(){},b.initPage=function(){b.SubscriberEmail="",b.responseMessage="",b.alerts=[],b.alertHTML="",b.Code="",b.logingRedirectLocation="/",b.mediaTitle="",b.mediaTypes=[{key:"img-link",value:"Image Link"},{key:"img-upload",value:"Image Upload"},{key:"video-link",value:"Video Link"},{key:"video-upload",value:"Video Upload"
}],b.mediaLink="",b.isMediaUploadable=!0,b.FullName="",b.Email="",b.Password="",b.PersonalInfo="",b.Address="",b.Permalink="",b.isProfilePage=!1,b.uploader.formData=[],b.showBrowseButton=!0,b.popupSignup=!0,b.notificationCounter=0,b.notifications=[],b.uid=null,b.itemId=0,b.userId=0,b.isAdmin=!1,b.commentId=null,b.commentsCount=0,b.authorName="",b.authorImage=null,b.unHeart=!1,b.heartCounter=0,b.socialCounter=function(){b.countSocialShares(),b.countSocialFollowers()}},b.heartAction=function(){userId=d.uid,ItemId=d.itemId,permalink=d.plink,section="ideas",0!=userId&&c({url:"/api/heart/add-heart",method:"POST",data:{uid:userId,iid:ItemId,plink:permalink,section:section,uht:b.unHeart}}).success(function(a){b.heartCounterAction(),b.unHeart=!b.unHeart})},b.heartCounterAction=function(){userId=d.uid,ItemId=d.itemId,section="ideas",c({url:"/api/heart/count-heart",method:"POST",data:{uid:userId,iid:ItemId,section:section}}).success(function(a){b.unHeart=a.UserStatus,b.heartCounter=a.Count})},b.addAlert=function(a,c){b.alertHTML=c,b.alerts.push({type:a})},b.closeAlert=function(a){b.alerts.splice(a,1)},b.buildErrorMessage=function(a){var b="";return b="<ul>",angular.forEach(a,function(a,c){b+="<li>"+a+"</li>"}),b+="</ul>"},b.outputStatus=function(a,c){var d=a.status_code;switch(d){case 400:"Validation failed"==a.data.error.message[0]&&b.addAlert("danger",b.buildErrorMessage(a.data.error.message[1]));break;case 401:b.addAlert("danger",a.data.error.message);break;case 200:b.addAlert("success",c),"Successfully password reset"==c?window.location="/login":"Registration completed successfully"==a.data?b.loginUser():"Registration completed successfully,please verify email"==a.data&&b.loginUser();break;case 210:b.addAlert("",c);break;case 220:"Successfully authenticated."==a.data.message?b.redirectUser(a.data.roles):b.addAlert("success",a.data.message);break;case 410:b.addAlert("danger",a.data.error.message);break;case 500:b.addAlert("danger",a.data.error.message);break;default:b.addAlert("danger","Request failed !")}},b.redirectUser=function(a){switch(a[0]){case"admin":window.location="/admin/dashboard";break;case"editor":window.location="/admin/dashboard";break;case"user":window.location="/user/profile"}},b.getAuthorInfoByEmail=function(a){c({url:"/api/info-raw/"+a,method:"GET"}).success(function(a){b.authorName=a.name,b.authorImage=a.medias[0].media_link,b.authorBio=a.user_profile.personal_info})},b.addCommentForIdeas=function(a,d,e,f){console.log(a,d,e,f),c({url:"/api/comment/add-ideas-comment",method:"POST",data:{uid:a,pid:d,plink:e,comment:f}}).success(function(a){b.html="",b.getCommentsForIdeas(b.itemId)})},b.getCommentsForIdeas=function(a){c({url:"/api/comment/get-ideas-comment/"+a,method:"GET"}).success(function(c){b.itemId=a,b.comments=c.data,b.commentsCount=b.comments.length,b.commentsCountView=b.commentsCount<2?b.commentsCount+" Comment":b.commentsCount+" Comments"})},b.initCommentCounter=function(){},b.editComment=function(a){b.isEdit=!0,b.commentId=a.CommentId,b.html=a.Comment},b.updateComment=function(a){c({url:"/api/comment/update-comment",method:"POST",data:{cid:b.commentId,comment:b.html}}).success(function(a){b.html="",b.isEdit=!1,b.getCommentsForIdeas(b.itemId)})},b.deleteComment=function(a){c({url:"/api/comment/delete-comment",method:"POST",data:{cid:a}}).success(function(a){b.getCommentsForIdeas(b.itemId)})},b.subscribe=function(a){b.responseMessage="","undefined"!=typeof a.SubscriberEmail&&(b.SubscriberEmail=a.SubscriberEmail),c({url:"/api/subscribe",method:"POST",data:{Email:b.SubscriberEmail,SetCookie:"true"}}).success(function(a){406==a.status_code?b.responseMessage="Invalid Email !":200==a.status_code?(b.responseMessage="Successfully Subscribed",window.location="/signup/"+b.SubscriberEmail):b.responseMessage="Email already subscribed"})},b.registerSubscribedUser=function(){return b.closeAlert(),b.Password!=b.PasswordConf?void b.addAlert("danger","Password not match !"):void c({url:"/api/register-user",method:"POST",data:{FullName:b.FullName,Email:b.Email,Password:b.Password,Valid:!0}}).success(function(a){b.outputStatus(a,a.data)})},b.registerUser=function(a){return b.closeAlert(),b.Password!=b.PasswordConf?void b.addAlert("danger","Password not match !"):void c({url:"/api/register-user",method:"POST",data:{FullName:b.FullName,Email:b.Email,Password:b.Password,Valid:!1}}).success(function(a){b.outputStatus(a,a.data)})},b.registerWithFB=function(){window.location="/api/fb-login"},b.loginUser=function(){b.closeAlert(),c({url:"/api/authenticate",method:"POST",data:{Email:b.Email,Password:b.Password,RememberMe:1==b.rememberMe}}).success(function(a){var d="https://ideaing.com/ideas/api?call=login&username="+b.Email+"&password="+b.Password+"&remember="+b.rememberMe;c({url:d,method:"GET"}).success(function(a){var b=f.search().from;"cms"===b&&(window.location="https://ideaing.com/ideas/wp-admin")}).error(function(a,b,c,d){if(a.success){var e=f.search().from;"cms"===e&&(window.location="https://ideaing.com/ideas/wp-admin")}}),b.outputStatus(a,a.data)})},b.logoutUser=function(){var a="/ideas/api?call=logout";c({url:a,method:"GET"}).success(function(a){window.location="/api/logout"}).error(function(a){window.location="/api/logout"})},b.passwordResetRequest=function(){b.closeAlert(),c({url:"/password-reset-request/"+b.Email,method:"GET"}).success(function(a){b.outputStatus(a,a.data)})},b.passwordReset=function(){return b.closeAlert(),b.Password!=b.PasswordConf?void b.addAlert("danger","Password not match !"):void c({url:"/api/password-reset",method:"POST",data:{Password:b.Password,Code:b.Code}}).success(function(a){b.outputStatus(a,a.data)})},b.updateUser=function(a,d){b.closeAlert(),c({url:"/api/change-profile",method:"POST",data:{FullName:a.FullName,Email:a.Email,Password:a.Password,PersonalInfo:a.PersonalInfo,Address:a.Address,Permalink:a.Permalink,MediaLink:d}}).success(function(a){b.outputStatus(a,"User information updated successfully"),location.reload()})},b.initProfilePage=function(){b.isProfilePage=!0,b.uploader.formData.push({isProfilePage:1})},b.initProfilePicture=function(a){b.mediaLink=a},b.updateProfilePicture=function(a,d){b.closeAlert(),c({url:"/api/change-profile",method:"POST",data:{FullName:a.FullName,Email:a.Email,MediaLink:d}}).success(function(a){b.outputStatus(a,"Profile picture updated successfully"),b.showBrowseButton=!b.showBrowseButton})},b.cancelPictureUpdate=function(){b.mediaLink=b.oldMediaLink,b.showBrowseButton=!b.showBrowseButton},b.loadNotification=function(a){b.uid=a,c({url:"/api/notification/"+a,method:"GET"}).success(function(a){b.notificationCounter=a.data.NotReadNoticeCount,b.notifications=a.data.NoticeNotRead})},b.readAllNotification=function(){c({url:"/api/read-all-notification/"+b.uid,method:"GET"}).success(function(a){b.loadNotification(b.uid)})},b.chk=function(){b.closeAlert(),c({url:"/secure-page-header",method:"GET"}).success(function(a){})},b.countSocialShares=function(){var a=window.location.host+window.location.pathname;c({url:"/api/social/get-social-counts",method:"GET",params:{url:a}}).success(function(a){$(".share-count.all").html(a.all),$(".share-count.twi").html(a.twitter),$(".share-count.fb").html(a.facebook),$(".share-count.gp").html(a.gplus),$(".share-count.pint").html(a.pinterest),$(".share-count.inst").html(a.instagram)})},b.countSocialFollowers=function(){var a=window.location.host+window.location.pathname;c({url:"/api/social/get-fan-counts",method:"GET",params:{url:a}}).success(function(a){$(".fan-count.twi").html(a.twitter),$(".fan-count.fb").html(a.facebook),$(".fan-count.gp").html(a.gplus),$(".fan-count.pint").html(a.pinterest),$(".fan-count.inst").html(a.instagram)})},b.initPage()}]);